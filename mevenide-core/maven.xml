<?xml version="1.0" encoding="UTF-8"?>
<project xmlns:j="jelly:core">
	
	<!-- crap -->
	<preGoal name="test:test">
		<copy toDir="target/test-classes">
		  <fileset dir="src/test/etc">
  			<include name="*.properties"/>
  			<include name="*.xml"/>
		  </fileset>
		</copy>
		<copy toDir="target/test-classes">
		  <fileset dir="etc">
  			<include name="*.properties"/>
  			<include name="*.xml"/>
		  </fileset>
		</copy>
		<copy toDir="target/test-classes/META-INF/services">
		  <fileset dir="etc/META-INF/services">
  			<include name="*.*"/>
		  </fileset>
		</copy>
	</preGoal>
	
	<preGoal name="jar:jar">
		<copy toDir="target/classes/META-INF/services">
		  <fileset dir="etc/META-INF/services">
  			<include name="*.*"/>
		  </fileset>
		</copy>
		<copy toDir="target/classes/templates/standard">
		  <fileset dir="etc/templates/standard">
  			<include name="*.*"/>
		  </fileset>
		</copy>
	</preGoal>
	
	<postGoal name="jar:install">
		<copy file="etc/mevenide.properties" todir="../mevenide-ui-eclipse/etc"/> 
		<attainGoal name="mevenide:prepare-lib"/>
	</postGoal>
	
	
	<goal name="mevenide:prepare-lib">
		<!-- copy dependencies to mevenide lib directory -->
		<j:forEach var="dependency" items="${pom.dependencies}">
			<j:if test="${!(dependency.groupId.equals('eclipse') || dependency.artifactId.startsWith('mock') || dependency.artifactId.endsWith('mock') || dependency.groupId.startsWith('junit'))}">
            	<copy file="${maven.repo.local}/${dependency.groupId}/${dependency.type}s/${dependency.artifactId}-${dependency.version}.${dependency.type}" 
            		  todir="../mevenide-ui-eclipse/lib"/>
            </j:if>
        </j:forEach>
	</goal>
</project>