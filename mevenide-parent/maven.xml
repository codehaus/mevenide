<?xml version="1.0" encoding="UTF-8"?>
<project xmlns:ant="jelly:ant"
		 xmlns:util="jelly:util"
		 xmlns:j="jelly:core">
  <preGoal name="build:start">
	<util:file var="filters" name="../mevenide-master/scripts/init/init-filtersets.xml"/>
	<j:include file="${filters}"/>
  </preGoal>
  <goal name="mevenide:clean-lib">
     <ant:delete>
        <ant:fileset dir="${basedir}" includes="lib/*.jar"/>
     </ant:delete> 
  </goal>
  
<!--
  # Correct the XDoc maven.xdoc.jsl property.
  #
  # The maven.xdoc.jsl property is used by Maven's XDoc plugin to specify
  # the JSL stylesheet used to convert xdocs to HTML. It is possible that
  # this property refers to a file on the local file system. In that case
  # the URL should be prepended with "file://". However, this does not
  # work on Windows systems. To use this property on a Windows system, the
  # URL needs to start with "file:/" (single slash instead of double slash)
  # or "file:///". This preGoal attempts to determine which operating system
  # is in use and corrects the URL if it refers to a file in the local file
  # system.
 -->
<preGoal name="xdoc:init">
  <j:set var="o" value="${os.name}"/>
  <j:set var="u" value="${maven.xdoc.jsl}"/>
  <j:if test="${o.startsWith('Windows') and !empty(u) and !u.startsWith('file:///') and u.startsWith('file://')}">
    <util:replace var="maven.xdoc.jsl" value="file:///${u.substring(7)}" oldChar="\" newChar="/"/>
    <ant:echo level="verbose" message="maven.xdoc.jsl old: ${u}"/>
    <ant:echo level="verbose" message="maven.xdoc.jsl new: ${maven.xdoc.jsl}"/>
  </j:if>
</preGoal>  

</project>